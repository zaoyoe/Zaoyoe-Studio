<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>æˆ‘ä»¬çš„åº—é“º - èµ„æºå¯¼èˆª</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Outfit:wght@500;700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="style.css?v=FIX_LAYOUT_SHIFT_MODAL">
    <link rel="stylesheet" href="security-cards.css?v=NO_LAYOUT_SHIFT">
    <link rel="stylesheet" href="login_styles.css?v=FIX_CURSOR_FINAL">
    <link rel="stylesheet" href="login_dual_mode.css">
    <link rel="stylesheet" href="avatar-fix.css?v=FIX_AVATAR_SQUASH">
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script type="text/javascript">
        (function () {
            // Replace with your Public Key
            emailjs.init("vawaxLVEzJMAVbut0");
        })();
    </script>
    <!-- LeanCloud SDK -->
    <script src="https://cdn.jsdelivr.net/npm/leancloud-storage@4.15.2/dist/av-min.js"></script>
    <script src="./leancloud-init.js?v=1764163660" defer></script>
    <script src="./leancloud-auth-functions.js?v=NO_AUTO_SELECT_V1" defer></script>
    <script src="./leancloud-guestbook-functions.js?v=1764163660" defer></script>
    <script src="./security-cards.js?v=CLEAN_V1" defer></script>

    <!-- Google Sign-In SDK -->
    <script src="https://accounts.google.com/gsi/client" async defer></script>

    <!-- Google OAuth Implementation -->
    <script src="./google-oauth.js?v=20251126_CORRECT_CLIENT_ID" defer></script>

    <style>
        /* Homepage entrance animation - Subtle */
        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(15px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .glass-box {
            opacity: 0;
            /* Start hidden to prevent flash */
            animation: fadeInUpElastic 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
            /* Elastic entrance */
            /* Transition for magnetic effect - separate from animation */
            transition: transform 0.1s ease-out, background 0.3s ease, box-shadow 0.3s ease;
        }

        /* Subtle stagger animation for each card */
        .glass-box:nth-child(1) {
            animation-delay: 0.1s;
        }

        .glass-box:nth-child(2) {
            animation-delay: 0.15s;
        }

        .glass-box:nth-child(3) {
            animation-delay: 0.2s;
        }

        .glass-box:nth-child(4) {
            animation-delay: 0.25s;
        }

        .glass-box:nth-child(5) {
            animation-delay: 0.3s;
        }

        .glass-box:nth-child(6) {
            animation-delay: 0.35s;
        }

        .glass-box:nth-child(7) {
            animation-delay: 0.4s;
        }

        .glass-box:nth-child(8) {
            animation-delay: 0.45s;
        }

        .glass-box:nth-child(9) {
            animation-delay: 0.5s;
        }

        .glass-box:nth-child(10) {
            animation-delay: 0.55s;
        }
    </style>
    <style>
        /* FORCE FIX: Input Visibility - Simple & Clean */
        .guestbook-form input,
        .guestbook-form textarea,
        .modal-content input,
        .modal-content textarea,
        .modal-content select,
        .login-card input,
        .login-card textarea,
        .nickname-edit input,
        .security-input {
            background: rgba(255, 255, 255, 0.35) !important;
            border: 1.5px solid rgba(255, 255, 255, 0.5) !important;
            color: #ffffff !important;
            caret-color: #ffffff !important;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.6) !important;
        }

        .guestbook-form input:focus,
        .modal-content input:focus,
        .login-card input:focus,
        .nickname-edit input:focus {
            background: rgba(255, 255, 255, 0.45) !important;
            border-color: rgba(255, 255, 255, 0.7) !important;
            box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.1) !important;
        }

        /* FORCE FIX: Placeholder Color */
        ::placeholder {
            color: rgba(255, 255, 255, 0.65) !important;
            opacity: 1 !important;
        }

        /* FORCE FIX: Auth Button Children */
        #authBtn * {
            pointer-events: none !important;
        }
    </style>
    <script>
        // FORCE FIX: Global Auth Handler
        window.toggleAuthMenu = function (e) {
            if (e) e.stopPropagation();
            console.log('ğŸ”˜ toggleAuthMenu called (INLINE)');

            const navAvatar = document.getElementById('navUserAvatar');
            // Check visibility directly
            const isVisible = navAvatar && (navAvatar.style.display === 'block' || navAvatar.style.display === 'inline-block');

            if (isVisible) {
                const dropdown = document.getElementById('userDropdown');
                if (dropdown) {
                    dropdown.classList.toggle('active');
                    console.log('ğŸ”½ Dropdown toggled');
                }
            } else {
                console.log('ğŸ” Triggering login');
                // Open login modal directly
                const loginModal = document.getElementById('loginModal');
                if (loginModal) {
                    loginModal.classList.add('active');
                } else {
                    console.error('âŒ loginModal not found');
                }
            }
        };

        // FORCE FIX: Dropdown Actions (Inline to guarantee availability)
        window.handleLogout = function (event) {
            if (event) event.stopPropagation();
            console.log('ğŸšª handleLogout called (INLINE)');

            // Close dropdown
            const dropdown = document.getElementById('userDropdown');
            if (dropdown) dropdown.classList.remove('active');

            if (!confirm("ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ")) return;

            // Clear LeanCloud user
            if (typeof AV !== 'undefined' && AV.User) {
                AV.User.logOut();
            }

            // Clear local storage
            localStorage.removeItem('cached_user_profile');
            localStorage.removeItem('remembered_credentials');

            // Reset UI
            const defaultIcon = document.getElementById('defaultAuthIcon');
            const navAvatar = document.getElementById('navUserAvatar');
            const btnText = document.getElementById('authBtnText');

            if (defaultIcon) defaultIcon.style.display = 'inline';
            if (navAvatar) navAvatar.style.display = 'none';
            if (btnText) btnText.textContent = 'Sign In';

            const authBtn = document.getElementById('authBtn');
            if (authBtn) authBtn.classList.remove('logged-in');

            console.log('âœ… Logged out successfully');
        };

        window.handleSwitchAccount = function (event) {
            if (event) event.stopPropagation();
            console.log('ğŸ”„ handleSwitchAccount called (INLINE)');

            // Close dropdown
            const dropdown = document.getElementById('userDropdown');
            if (dropdown) dropdown.classList.remove('active');

            // Logout first
            if (typeof AV !== 'undefined' && AV.User) {
                AV.User.logOut();
            }
            localStorage.removeItem('cached_user_profile');
            localStorage.removeItem('remembered_credentials');

            // Reset UI
            const defaultIcon = document.getElementById('defaultAuthIcon');
            const navAvatar = document.getElementById('navUserAvatar');
            const btnText = document.getElementById('authBtnText');

            if (defaultIcon) defaultIcon.style.display = 'inline';
            if (navAvatar) navAvatar.style.display = 'none';
            if (btnText) btnText.textContent = 'Sign In';

            // Open login modal after a short delay
            setTimeout(() => {
                const loginModal = document.getElementById('loginModal');
                if (loginModal) {
                    loginModal.classList.add('active');
                    loginModal.style.visibility = 'visible';
                    loginModal.style.opacity = '1';
                    loginModal.style.display = 'flex';
                }
            }, 200);
        };


    </script>
    <script>
        // Page load animation trigger
        document.addEventListener('DOMContentLoaded', function () {
            // Animation already triggered by CSS on load
        });
    </script>
</head>

<body class="shop-page">
    <div class="background-blobs">
        <div class="blob blob-1"></div>
        <div class="blob blob-2"></div>
        <div class="blob blob-3"></div>
    </div>

    <!-- Dropdown Backdrop (Controlled by CSS :has) -->
    <div class="dropdown-backdrop" style="z-index: 1998;"></div>

    <div class="bento-container">
        <!-- Profile & Clock Card (2x2) -->

        <div class="glass-box box-profile">
            <div class="profile-header">
                <div class="date-time-compact">
                    <div id="current-time" style="font-size: 1.1rem; color: rgba(255,255,255,0.7); font-weight: 600;">
                        09:15:21</div>
                    <div id="current-date" style="font-size: 0.85rem; color: rgba(255,255,255,0.5); margin-top: 3px;">
                        2025å¹´11æœˆ23æ—¥</div>
                </div>
            </div>
            <div class="profile-main">
                <div class="shop-heading-large">Zaoyoe</div>

            </div>
        </div>

        <!-- Gemini Card (2x1) - Interactive -->
        <div class="glass-box box-wide" data-modal-target="geminiModal">
            <!-- Custom SVG for Gemini 4-point Star -->
            <svg class="icon-large gemini-star" viewBox="0 0 24 24" fill="currentColor"
                xmlns="http://www.w3.org/2000/svg" style="width: 48px; height: 48px;">
                <path d="M12 0L14.5 9.5L24 12L14.5 14.5L12 24L9.5 14.5L0 12L9.5 9.5L12 0Z" />
            </svg>
            <div class="box-label">Gemini ä¸“åŒº</div>
        </div>

        <!-- Google Card (2x1) -->
        <a href="#" class="glass-box box-wide" data-modal-target="googleModal">
            <i class="fa-brands fa-google icon-large" style="color: #ea4335;"></i>
            <div class="box-label">Google é‚®ç®±</div>
        </a>

        <!-- Taobao Card (1x1) -->
        <div class="glass-box box-small">
            <i class="fa-solid fa-cart-shopping icon-large" style="color: #ff5000;"></i>
            <div class="box-label">æ·˜å®åº—é“º</div>
        </div>

        <!-- Xianyu Card (1x1) -->
        <div class="glass-box box-small">
            <i class="fa-solid fa-fish icon-large" style="color: #ffda44;"></i>
            <div class="box-label">é—²é±¼åº—é“º</div>
        </div>

        <!-- 3D Design (2x1) - Wide -->
        <div class="glass-box box-wide" data-modal-target="comingSoonModal">
            <i class="fa-solid fa-cube icon-large" style="color: #06b6d4;"></i>
            <div class="box-label">ä¸‰ç»´è®¾è®¡</div>
        </div>

        <!-- Post-production (2x1) - Wide -->
        <div class="glass-box box-wide" data-modal-target="comingSoonModal">
            <i class="fa-solid fa-clapperboard icon-large" style="color: #8b5cf6;"></i>
            <div class="box-label">å½±è§†åæœŸ</div>
        </div>

        <!-- Contact Card (1x1) - Clickable -->
        <div class="glass-box box-small" data-modal-target="contactModal">
            <i class="fa-solid fa-address-card icon-large" style="color: #d946ef;"></i>
            <div class="box-label">è”ç³»æˆ‘ä»¬</div>
        </div>

        <!-- Guestbook Card (1x1) - Interactive -->
        <div class="glass-box box-small" data-modal-target="guestbookModal">
            <i class="fa-regular fa-comment-dots icon-large" style="color: #f59e0b;"></i>
            <div class="box-label">ç•™è¨€æ¿</div>
        </div>
    </div>



    <!-- Guestbook Modal -->
    <div class="modal-overlay" id="guestbookModal" onclick="closeModal(event)">
        <div class="modal-content guestbook-content premium-modal" style="position: relative;"
            onclick="event.stopPropagation()">
            <!-- Mac Window Controls -->
            <div class="mac-controls">
                <div class="mac-dot red" onclick="closeModal(event)">
                    <i class="fas fa-times"></i>
                </div>
                <div class="mac-dot yellow"></div>
                <div class="mac-dot green"></div>
            </div>

            <div class="modal-title">ç•™è¨€æ¿</div>
            <p class="modal-subtitle" style="pointer-events: none; user-select: none;">
                æ¬¢è¿ç•™ä¸‹æ‚¨çš„å®è´µå»ºè®®,æˆ–å‘Šè¯‰æˆ‘ä»¬æ‚¨æœŸå¾…ä¸Šæ¶çš„å•†å“ã€‚
            </p>
            <form class="guestbook-form" id="guestbookForm">
                <!-- Nickname input removed - Will use logged in user -->

                <div class="input-group relative-container">
                    <textarea id="guestMessage" placeholder="å†™ä¸‹æ‚¨çš„ç•™è¨€... (Message)"></textarea>

                    <!-- Integrated Upload Icon -->
                    <div class="upload-icon-wrapper">
                        <input type="file" id="imageUpload" accept="image/*" style="display: none;">
                        <button type="button" class="upload-icon-btn"
                            onclick="document.getElementById('imageUpload').click()" title="ä¸Šä¼ å›¾ç‰‡">
                            <i class="fas fa-camera"></i>
                        </button>
                    </div>
                </div>

                <div id="imagePreview" class="image-preview-container" style="display: none;">
                    <img id="previewImg" src="" alt="Preview">
                    <button type="button" class="remove-image-btn" id="removeImageBtn"></button>
                </div>

                <button type="submit" class="submit-btn"
                    style="display: flex; align-items: center; justify-content: center; gap: 8px;">
                    <i class="fas fa-paper-plane"></i>
                    ç•™è¨€
                </button>
            </form>

            <!-- View More Button -->
            <a href="guestbook.html" class="view-more-btn">
                <i class="fas fa-comment-dots"></i>
                æŸ¥çœ‹æ›´å¤š
            </a>
        </div>
    </div>

    <!-- Contact Modal -->
    <div class="modal-overlay" id="contactModal" onclick="closeModal(event)">
        <div class="modal-content premium-modal" style="position: relative;">
            <!-- Mac Window Controls -->
            <div class="mac-controls">
                <div class="mac-dot red" onclick="closeModal(event)">
                    <i class="fas fa-times"></i>
                </div>
            </div>

            <div class="modal-title">è”ç³»æˆ‘ä»¬</div>
            <p class="modal-subtitle">
                é€‰æ‹©æ‚¨å–œæ¬¢çš„è”ç³»æ–¹å¼
            </p>

            <div class="modal-grid">
                <!-- Email Card -->
                <div class="modal-link-card" onclick="copyText('zaoyoe@gmail.com'); event.stopPropagation();"
                    style="cursor: pointer;">
                    <i class="fa-solid fa-envelope"></i>
                    <div class="link-title">ç”µå­é‚®ç®±</div>
                    <div class="contact-detail" style="font-size: 0.9rem; opacity: 0.8; margin-top: 5px;">
                        zaoyoe@gmail.com</div>
                    <div class="contact-hint" style="font-size: 0.75rem; opacity: 0.5; margin-top: 2px;">(ç‚¹å‡»å¤åˆ¶)</div>
                </div>

                <!-- WeChat Card -->
                <div class="modal-link-card">
                    <i class="fa-brands fa-weixin"></i>
                    <div class="link-title">å¾®ä¿¡è”ç³»</div>
                    <img src="assets/wechat-qr-new.jpg" alt="WeChat QR"
                        style="width: 120px; height: 120px; border-radius: 12px; margin-top: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.3);">
                </div>
            </div>
        </div>
    </div>

    <!-- Gemini Modal -->
    <div class="modal-overlay" id="geminiModal" onclick="closeModal(event)">
        <div class="modal-content premium-modal" style="position: relative;">
            <!-- Mac Window Controls -->
            <div class="mac-controls">
                <div class="mac-dot red" onclick="closeModal(event)">
                    <i class="fas fa-times"></i>
                </div>
            </div>

            <div class="modal-title">Gemini ä¸“åŒº</div>
            <p class="modal-subtitle">
                æ¢ç´¢ Gemini çš„æ— é™å¯èƒ½
            </p>

            <div class="modal-grid">
                <a href="gemini_guide.html" class="modal-link-card">
                    <i class="fa-solid fa-book"></i>
                    <div class="link-title">ä½¿ç”¨è§„èŒƒ</div>
                </a>

                <a href="gemini_binding.html" class="modal-link-card">
                    <i class="fa-solid fa-credit-card"></i>
                    <div class="link-title">ç»‘å¡æ•™ç¨‹</div>
                </a>
            </div>
        </div>
    </div>

    <!-- Google Modal -->
    <div class="modal-overlay" id="googleModal" onclick="closeModal(event)">
        <div class="modal-content premium-modal" style="position: relative;">
            <!-- Mac Window Controls -->
            <div class="mac-controls">
                <div class="mac-dot red" onclick="closeModal(event)">
                    <i class="fas fa-times"></i>
                </div>
            </div>

            <div class="modal-title">Google é‚®ç®±ä¸“åŒº</div>
            <p class="modal-subtitle">
                é«˜è´¨é‡è°·æ­Œè´¦å·æœåŠ¡
            </p>

            <div class="modal-grid" style="display: flex; justify-content: center;">
                <a href="google_guide.html" class="modal-link-card">
                    <i class="fa-solid fa-book"></i>
                    <div class="link-title">ä½¿ç”¨è§„èŒƒ</div>
                </a>
            </div>
        </div>
    </div>

    <!-- Login Trigger Button (Top Right) -->
    <div class="top-right-nav" style="position: fixed; top: 30px; right: 40px; z-index: 2100;">
        <button id="authBtn" class="login-trigger-btn" onclick="window.toggleAuthMenu(event)">
            <!-- Default Icon (shown when logged out) -->
            <i id="defaultAuthIcon" class="fas fa-user-circle" style="font-size: 1.2rem;"></i>

            <!-- User Avatar (shown when logged in) -->
            <img id="navUserAvatar" class="nav-user-avatar" src="" alt="Avatar" style="display: none;">

            <span id="authBtnText">Sign In</span>
        </button>

        <div id="userDropdown" class="user-dropdown" style="z-index: 2100;">
            <!-- Personal Profile -->
            <div class="menu-item profile-menu-item" onclick="window.openProfileModal(event)">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                    <circle cx="12" cy="7" r="4"></circle>
                </svg>
                ä¸ªäººèµ„æ–™
            </div>

            <div class="divider" style="margin: 5px 0; border-top: 1px solid rgba(255,255,255,0.1);"></div>

            <div class="menu-item switch-account" onclick="window.handleSwitchAccount(event)">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                    <circle cx="9" cy="7" r="4"></circle>
                    <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                    <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                </svg>
                åˆ‡æ¢è´¦æˆ·
            </div>

            <div class="menu-item logout" onclick="console.log('Logout clicked'); window.handleLogout(event)">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                    <polyline points="16 17 21 12 16 7"></polyline>
                    <line x1="21" y1="12" x2="9" y2="12"></line>
                </svg>
                Log Out
            </div>
        </div>
    </div>


    <!-- Auth Modal (Dual Mode) -->
    <div class="login-overlay" id="loginModal" onclick="handleLoginOverlayClick(event)">
        <div class="login-card" onclick="event.stopPropagation()">
            <!-- Mac Window Controls -->
            <div class="mac-controls">
                <div class="mac-dot red" onclick="toggleLoginModal()">
                    <i class="fas fa-times"></i>
                </div>
                <div class="mac-dot yellow"></div>
                <div class="mac-dot green"></div>
            </div>

            <!-- Login View -->
            <div id="loginView" class="form-view">
                <h2 class="card-title">æ¬¢è¿å›æ¥</h2>
                <p class="card-subtitle">è¯·è¾“å…¥æ‚¨çš„è´¦å·ä¿¡æ¯ä»¥ç™»å½•</p>

                <!-- Google Login Button -->
                <button type="button" class="google-login-btn" onclick="handleGoogleLogin()">
                    <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google"
                        width="18" height="18">
                    ä½¿ç”¨ Google ç™»å½•
                </button>

                <!-- Divider -->
                <div class="login-divider">
                    <span>æˆ–è€…</span>
                </div>

                <form id="loginForm" onsubmit="handleLogin(event)">
                    <div class="input-group">
                        <input type="email" id="login-email" class="glass-input" placeholder="é‚®ç®±åœ°å€" required>
                    </div>
                    <div class="input-group">
                        <input type="password" id="login-password" class="glass-input" placeholder="å¯†ç " required>
                    </div>

                    <!-- Forgot Password Link -->
                    <div style="text-align: right; margin-bottom: 16px;">
                        <span class="forgot-password-link" onclick="switchAuthView('reset')">å¿˜è®°å¯†ç äº†å—ï¼Ÿ</span>
                    </div>

                    <!-- Remember Me Checkbox -->
                    <div class="checkbox-wrapper"
                        style="margin-bottom: 24px; display: flex; align-items: center; gap: 8px; color: rgba(255,255,255,0.7); font-size: 13px;">
                        <input type="checkbox" id="rememberMe" class="custom-checkbox"
                            style="width: 16px; height: 16px; accent-color: #9b5de5; cursor: pointer;"
                            title="å‹¾é€‰åå°†è‡ªåŠ¨ä¿å­˜æ‚¨çš„ç™»å½•ä¿¡æ¯ï¼Œ30å¤©å†…æ— éœ€é‡å¤è¾“å…¥å¯†ç ">
                        <label for="rememberMe" style="cursor: pointer;"
                            title="å‹¾é€‰åå°†è‡ªåŠ¨ä¿å­˜æ‚¨çš„ç™»å½•ä¿¡æ¯ï¼Œ30å¤©å†…æ— éœ€é‡å¤è¾“å…¥å¯†ç ">è®°ä½å¯†ç </label>
                    </div>

                    <button type="submit" class="login-submit-btn">ç™»å½•</button>
                </form>

                <div class="switch-text">
                    è¿˜æ²¡æœ‰è´¦å·ï¼Ÿ
                    <span class="switch-link" onclick="switchAuthView('register')">ç«‹å³æ³¨å†Œ</span>
                </div>
            </div>

            <!-- Register View -->
            <div id="registerView" class="form-view hidden">
                <h2 class="card-title">åˆ›å»ºè´¦å·</h2>
                <p class="card-subtitle">åŠ å…¥æˆ‘ä»¬ä»¥è·å–æ›´å¤šé«˜çº§åŠŸèƒ½</p>

                <form id="registerForm" onsubmit="handleRegister(event)">
                    <div class="input-group">
                        <input type="text" id="reg-username" class="glass-input" placeholder="ç”¨æˆ·å" required>
                    </div>

                    <div class="input-group">
                        <input type="email" id="reg-email" class="glass-input" placeholder="é‚®ç®±åœ°å€" required>
                    </div>

                    <div class="input-group input-with-action">
                        <input type="text" id="reg-code" class="glass-input" placeholder="è¾“å…¥6ä½éªŒè¯ç " maxlength="6"
                            required>
                        <button type="button" class="verify-code-btn" id="sendBtn" onclick="sendVerificationCode()">
                            è·å–éªŒè¯ç 
                        </button>
                    </div>

                    <div class="input-group">
                        <input type="password" id="reg-password" class="glass-input" placeholder="è®¾ç½®å¯†ç " required>
                    </div>

                    <button type="submit" class="login-submit-btn">åˆ›å»ºè´¦å·</button>
                </form>

                <div class="switch-text">
                    å·²æœ‰è´¦å·ï¼Ÿ
                    <span class="switch-link" onclick="switchAuthView('login')">ç›´æ¥ç™»å½•</span>
                </div>
            </div>

            <!-- Password Reset View -->
            <div id="resetView" class="form-view hidden">
                <h2 class="card-title">æ‰¾å›å¯†ç </h2>
                <p class="card-subtitle">è¯·è¾“å…¥æ‚¨çš„æ³¨å†Œé‚®ç®±ä»¥é‡ç½®å¯†ç </p>

                <form id="resetForm" onsubmit="handlePasswordReset(event)">
                    <div class="input-group">
                        <input type="email" id="reset-email" class="glass-input" placeholder="ç”µå­é‚®ç®±" required>
                    </div>

                    <button type="submit" class="login-submit-btn" style="margin-top: 24px;">æ‰¾å›</button>
                </form>

                <div class="switch-text">
                    æ²¡æœ‰è´¦æˆ·ï¼Ÿ
                    <span class="switch-link" onclick="switchAuthView('register')">æ³¨å†Œ</span>
                </div>
                <div class="switch-text" style="margin-top: 10px;">
                    <span class="switch-link back-to-login" onclick="switchAuthView('login')">è¿”å›ç™»å½•</span>
                </div>
            </div>

        </div>
    </div>

    <!-- Coming Soon Modal -->
    <!-- Profile Modal -->
    <div class="modal-overlay" id="profileModal" onclick="closeModal(event)">
        <div class="modal-content profile-modal">
            <!-- Mac Window Controls -->
            <div class="mac-controls">
                <div class="mac-dot red" onclick="document.getElementById('profileModal').classList.remove('active')"><i
                        class="fas fa-times"></i></div>
                <div class="mac-dot yellow"></div>
                <div class="mac-dot green"></div>
            </div>

            <!-- Tab Navigation -->
            <div class="profile-tabs">
                <div class="tab-item active" onclick="switchProfileTab('profile')">èµ„æ–™</div>
                <div class="tab-item" onclick="switchProfileTab('security')">å®‰å…¨</div>
            </div>

            <!-- Flip Container -->
            <div class="profile-flip-container">
                <div class="profile-flip-inner">
                    <!-- View 1: Profile (Front) -->
                    <div id="view-profile" class="profile-view profile-front">
                        <div class="modal-title">ä¸ªäººèµ„æ–™</div>

                        <!-- Avatar Section -->
                        <div class="profile-avatar-section" onclick="triggerAvatarUpload()">
                            <img id="profileModalAvatar" src="" alt="Avatar">
                            <div class="avatar-upload-hint">
                                <i class="fas fa-camera"></i>
                                <span>æ›´æ¢å¤´åƒ</span>
                            </div>
                        </div>

                        <!-- Nickname Section -->
                        <div class="profile-nickname-section">
                            <!-- Display Mode -->
                            <div id="nicknameDisplay" class="nickname-display">
                                <span id="profileModalNickname">Loading...</span>
                                <i class="fas fa-pen edit-icon" onclick="toggleNicknameEdit(true)"></i>
                            </div>

                            <!-- Edit Mode -->
                            <div id="nicknameEdit" class="nickname-edit" style="display: none;">
                                <input type="text" id="nicknameInput" placeholder="è¾“å…¥æ–°æ˜µç§°">
                                <div class="edit-actions">
                                    <button class="cancel-btn" onclick="toggleNicknameEdit(false)">å–æ¶ˆ</button>
                                    <button class="save-btn" onclick="saveNickname()">ä¿å­˜</button>
                                </div>
                            </div>
                        </div>

                        <!-- Email Display -->
                        <div class="profile-email-section">
                            <label>é‚®ç®±åœ°å€</label>
                            <div id="profileModalEmail" class="profile-email-display"></div>
                        </div>

                        <!-- Hidden File Input (Moved here) -->
                        <input type="file" id="avatarUpload" accept="image/*" style="display: none;"
                            onchange="handleAvatarUpload(event)">

                        <!-- Member Since Badge -->
                        <div class="member-since-badge">
                            <i class="fas fa-calendar-alt"></i>
                            <span id="profileMemberSince">æ³¨å†Œäº 2025å¹´</span>
                        </div>
                    </div>

                    <!--  View 2: Security (Collapsible Cards) -->
                    <div id="view-security" class="profile-view profile-back">
                        <div class="modal-title">å®‰å…¨è®¾ç½®</div>

                        <div class="security-cards-layout">
                            <!-- Left: Security Menu Cards -->
                            <div class="security-menu">
                                <!-- 1. Change Password Card -->

                                <div class="security-card active"
                                    onclick="expandSecurityCard(event, 'change-password')">
                                    <div class="security-card-icon">
                                        <i class="fas fa-key"></i>
                                    </div>
                                    <div class="security-card-content">
                                        <div class="security-card-title">ä¿®æ”¹å¯†ç </div>
                                    </div>
                                    <i class="fas fa-chevron-right security-card-arrow"></i>
                                </div>

                                <!-- 2. Bind Phone Card -->
                                <div class="security-card" onclick="expandSecurityCard(event, 'bind-phone')">
                                    <div class="security-card-icon">
                                        <i class="fas fa-mobile-alt"></i>
                                    </div>
                                    <div class="security-card-content">
                                        <div class="security-card-title">ç»‘å®šæ‰‹æœºå·</div>
                                    </div>
                                    <i class="fas fa-chevron-right security-card-arrow"></i>
                                </div>

                                <!-- 3. Delete Account Card -->
                                <div class="security-card danger-card"
                                    onclick="expandSecurityCard(event, 'delete-account')">
                                    <div class="security-card-icon danger">
                                        <i class="fas fa-exclamation-triangle"></i>
                                    </div>
                                    <div class="security-card-content">
                                        <div class="security-card-title danger">æ³¨é”€è´¦å·</div>
                                    </div>
                                    <i class="fas fa-chevron-right security-card-arrow"></i>
                                </div>
                            </div>

                            <!-- Right: Expanded Content Area -->
                            <div class="security-detail-panel" id="securityDetailPanel">
                                <!-- Change Password Panel -->

                                <!-- Default Security Overview Panel -->
                                <div class="security-detail-content" id="detail-security-overview"
                                    style="display: block;">
                                    <div
                                        style="display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%;">
                                        <div class="security-overview-icon-container" style="
                                            width: 80px; 
                                            height: 80px; 
                                            background: rgba(155, 93, 229, 0.1); 
                                            border-radius: 50%; 
                                            display: flex; 
                                            align-items: center; 
                                            justify-content: center; 
                                            margin-bottom: 24px;
                                            box-shadow: 0 0 30px rgba(155, 93, 229, 0.2);
                                        ">
                                            <i class="fas fa-shield-alt" style="font-size: 36px; color: #9b5de5;"></i>
                                        </div>
                                        <h3 class="detail-title">è´¦å·å®‰å…¨ä¸­å¿ƒ</h3>
                                        <p class="detail-desc">æ‚¨çš„è´¦å·å½“å‰å¤„äºå®‰å…¨ä¿æŠ¤ä¸­</p>
                                        <div style="
                                            margin-top: 20px; 
                                            padding: 12px 20px; 
                                            background: rgba(255, 255, 255, 0.05); 
                                            border-radius: 12px; 
                                            font-size: 13px; 
                                            color: rgba(255, 255, 255, 0.5);
                                            display: flex;
                                            align-items: center;
                                            gap: 8px;
                                        ">
                                            <i class="fas fa-info-circle"></i>
                                            è¯·ä»å·¦ä¾§é€‰æ‹©é¡¹ç›®è¿›è¡Œå®‰å…¨è®¾ç½®
                                        </div>
                                    </div>
                                </div>

                                <!-- Change Password Panel -->

                                <div class="security-detail-content" id="detail-change-password" style="display: none;">
                                    <h3 class="detail-title">ä¿®æ”¹å¯†ç </h3>
                                    <input type="password" id="oldPasswordInput" placeholder="å½“å‰å¯†ç "
                                        class="security-input">
                                    <input type="password" id="newPasswordInput" placeholder="æ–°å¯†ç  (è‡³å°‘6ä½)"
                                        class="security-input">
                                    <button class="gradient-btn" onclick="changePassword()">æ›´æ–°å¯†ç </button>
                                </div>

                                <!-- Bind Phone Panel -->
                                <div class="security-detail-content" id="detail-bind-phone" style="display: none;">
                                    <h3 class="detail-title">ç»‘å®šæ‰‹æœºå·</h3>
                                    <p class="detail-desc">ç»‘å®šæ‰‹æœºå·å¯ä»¥å¢å¼ºè´¦æˆ·å®‰å…¨æ€§</p>
                                    <div class="input-group input-with-action"
                                        style="max-width: 100%; margin-bottom: 12px;">
                                        <input type="tel" id="phoneNumberInput" placeholder="è¾“å…¥æ‰‹æœºå·"
                                            class="security-input" maxlength="11">
                                        <button type="button" class="verify-code-btn" id="sendPhoneCodeBtn"
                                            onclick="sendPhoneVerificationCode()">
                                            è·å–éªŒè¯ç 
                                        </button>
                                    </div>
                                    <input type="text" id="phoneCodeInput" placeholder="è¾“å…¥6ä½éªŒè¯ç " class="security-input"
                                        maxlength="6">
                                    <button class="gradient-btn" onclick="bindPhone()">ç»‘å®šæ‰‹æœºå·</button>
                                </div>

                                <!-- Delete Account Panel -->
                                <div class="security-detail-content" id="detail-delete-account">
                                    <h3 class="detail-title danger">æ³¨é”€è´¦å·</h3>
                                    <p class="detail-desc">âš ï¸ æ­¤æ“ä½œä¸å¯æ¢å¤ï¼Œæ‚¨çš„æ‰€æœ‰æ•°æ®å°†è¢«æ°¸ä¹…åˆ é™¤ã€‚</p>
                                    <div class="danger-zone">
                                        <button class="danger-btn" onclick="deleteAccount()">
                                            <i class="fas fa-trash-alt"></i>
                                            ç¡®è®¤æ³¨é”€
                                        </button>
                                    </div>
                                </div>


                            </div>
                        </div>

                        <!-- Mobile Security Layout (Visible only on mobile) -->
                        <div class="mobile-security-layout">
                            <!-- Section 1: Change Password -->
                            <div class="mobile-security-section">
                                <h3 class="mobile-section-title">ä¿®æ”¹å¯†ç </h3>
                                <div class="input-group">
                                    <input type="password" id="mobile_oldPassword" class="security-input"
                                        placeholder="å½“å‰å¯†ç ">
                                </div>
                                <div class="input-group">
                                    <input type="password" id="mobile_newPassword" class="security-input"
                                        placeholder="æ–°å¯†ç  (è‡³å°‘6ä½)">
                                </div>
                                <button class="gradient-btn" onclick="changePassword('mobile')">æ›´æ–°å¯†ç </button>
                            </div>

                            <!-- Section 2: Bind Phone -->
                            <div class="mobile-security-section">
                                <h3 class="mobile-section-title">ç»‘å®šæ‰‹æœºå·</h3>
                                <p class="mobile-section-desc">ç»‘å®šæ‰‹æœºå·å¯ä»¥å¢å¼ºè´¦æˆ·å®‰å…¨æ€§</p>
                                <div class="input-group">
                                    <input type="tel" id="mobile_phoneNumberInput" class="security-input"
                                        placeholder="è¾“å…¥æ‰‹æœºå·">
                                </div>
                                <div class="input-group" style="display: flex; gap: 10px;">
                                    <input type="text" id="mobile_phoneCodeInput" class="security-input"
                                        placeholder="è¾“å…¥6ä½éªŒè¯ç " style="flex: 1;">
                                    <button class="code-btn" id="mobile_sendPhoneCodeBtn"
                                        onclick="sendPhoneVerificationCode('mobile')">è·å–éªŒè¯ç </button>
                                </div>
                                <button class="gradient-btn" onclick="bindPhone('mobile')">ç»‘å®šæ‰‹æœºå·</button>
                            </div>

                            <!-- Section 3: Delete Account -->
                            <div class="mobile-security-section">
                                <h3 class="mobile-section-title danger">æ³¨é”€è´¦å·</h3>
                                <p class="mobile-section-desc">âš ï¸ æ­¤æ“ä½œä¸å¯æ¢å¤ï¼Œæ‚¨çš„æ‰€æœ‰æ•°æ®å°†è¢«æ°¸ä¹…åˆ é™¤ã€‚</p>
                                <button class="danger-btn" onclick="deleteAccount()">
                                    <i class="fas fa-trash-alt"></i>
                                    ç¡®è®¤æ³¨é”€
                                </button>
                            </div>

                            <!-- Spacer removed as requested -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="comingSoonModal" onclick="closeModal(event)">
        <div class="modal-content premium-modal"
            style="position: relative; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 300px;">
            <!-- Mac Window Controls -->
            <div class="mac-controls" style="position: absolute; top: 20px; left: 20px;">
                <div class="mac-dot red" onclick="closeModal(event)">
                    <i class="fas fa-times"></i>
                </div>
            </div>

            <i class="fa-solid fa-rocket" style="font-size: 4rem; color: #8b5cf6; margin-bottom: 20px;"></i>
            <div class="modal-title">æ•¬è¯·æœŸå¾…</div>
            <p class="modal-subtitle">
                è¯¥åŠŸèƒ½æ­£åœ¨ç´§é”£å¯†é¼“åœ°å¼€å‘ä¸­...
            </p>
        </div>
    </div>

    <link rel="stylesheet" href="style.css?v=FIX_ANIMATION_FINAL">
    <link rel="stylesheet" href="style.css?v=FIX_INPUT_AVATAR_FINAL">
    <!-- Elastic Press Effect -->
    <script src="elastic-press.js?v=FIX_MODAL_DETECTION" defer></script>
    <script src="script.js?v=FIX_UI_OPTIMIZATIONS_V6" defer></script>
</body>

</html>

</html>